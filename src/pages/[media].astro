---
import BaseLayout from "../layouts/BaseLayout.astro";
import MediaGallery from "../components/Gallery";
import { getCollection } from "astro:content";
import { mapToMediaItem } from "../lib/mapToMediaItem";
import { Title } from "../components/ui";

export async function getStaticPaths() {
  const items = await getCollection("media");

  const types = [...new Set(items.map((item) => item.data.type))];
  return types.map((type) => ({
    params: { media: type },
  }));
}

const { media } = Astro.params;

const allItems = await getCollection("media");

const filtered = allItems
  .filter((item) => item.data.type === media)
  .map(mapToMediaItem);

const t = {
  video_and_motion: "Video & Motion",
  photography: "Photography",
  animation: "3D animation"
};
const pagetitle = t[media]
---

<BaseLayout pageTitle={media}>
  <Title text={pagetitle} size="lg" className="mb-6" />
  <MediaGallery items={filtered} client:visible />
</BaseLayout>
